<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨æ–¹ä½é€€ä¼‘æº–å‚™åº¦æª¢æ¸¬ | æ‚¨çš„å°ˆå±¬CFPé¡§å•</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --primary-color: #0056b3; /* å°ˆæ¥­è— */
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
        }
        body {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            background-color: var(--bg-color);
            color: #333;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        h1, h2 { color: var(--primary-color); text-align: center; }
        h1 { border-bottom: 2px solid #eee; padding-bottom: 20px; }
        .quadrant {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .quadrant h3 { margin-top: 0; color: #444; border-left: 5px solid var(--primary-color); padding-left: 10px;}
        .question-group { margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        .question-label { flex: 1; font-weight: 500; }
        .score-input { width: 60px; padding: 5px; text-align: center; }
        input[type="range"] { flex: 1; margin: 0 15px; cursor: pointer; }
        
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s;
        }
        .btn:hover { background-color: #004494; }
        .btn-download { background-color: #28a745; display: none; margin-top: 10px;} /* ç¶ è‰² */
        
        /* çµæœå€åŸŸæ¨£å¼ */
        #resultArea {
            display: none;
            margin-top: 40px;
            padding: 30px;
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            background-color: #fff;
        }
        .score-summary {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            background: #eee;
            padding: 10px;
            border-radius: 5px;
        }
        .advice-box { margin-bottom: 15px; }
        .advice-title { font-weight: bold; color: var(--primary-color); }
        .advice-content { font-size: 0.95em; color: #555; }
        .total-score { text-align: center; font-size: 1.5em; font-weight: bold; color: #d9534f; margin: 20px 0; }

        @media print {
            body { background: white; }
            .container { box-shadow: none; width: 100%; max-width: 100%; }
            .btn, input[type="range"] { display: none; }
            .score-val { display: inline-block !important; }
        }
    </style>
</head>
<body>

<div class="container" id="reportContent">
    <h1>æ·±åº¦è¨Šè™Ÿæª¢æ¸¬ï¼šå…¨æ–¹ä½é€€ä¼‘æº–å‚™åº¦</h1>
    <p style="text-align: center; color: #666;">è«‹ä¾æ“šç¾æ³è©•åˆ† (0åˆ†:æ¥µå·®/ç„¡ ~ 5åˆ†:å®Œç¾/å……è¶³)</p>

    <form id="quizForm">
        <div class="quadrant" id="q1">
            <h3>è±¡é™ä¸€ï¼šè²¡å‹™åŸºç«™ (ç¶“æ¿Ÿå®‰å…¨)</h3>
            <div id="q1-inputs"></div>
        </div>

        <div class="quadrant" id="q2">
            <h3>è±¡é™äºŒï¼šèº«å¿ƒçºŒèˆª (å¥åº·è³‡ç”¢)</h3>
            <div id="q2-inputs"></div>
        </div>

        <div class="quadrant" id="q3">
            <h3>è±¡é™ä¸‰ï¼šç¤¾äº¤æ¼«éŠ (ç¤¾æœƒé€£çµ)</h3>
            <div id="q3-inputs"></div>
        </div>

        <div class="quadrant" id="q4">
            <h3>è±¡é™å››ï¼šç¬¬äºŒäººç”Ÿ (è‡ªæˆ‘å¯¦ç¾)</h3>
            <div id="q4-inputs"></div>
        </div>

        <button type="button" class="btn" onclick="generateReport()">é–‹å§‹è¨ºæ–·ä¸¦ç”Ÿæˆå ±å‘Š</button>
    </form>

    <div id="resultArea">
        <h2 style="margin-top:0;">ã€æ‚¨çš„å°ˆå±¬é€€ä¼‘è¨ºæ–·æ›¸ã€‘</h2>
        <div class="total-score" id="totalScoreDisplay"></div>
        <div class="score-summary" id="scoreBreakdown"></div>
        <hr>
        <div id="adviceContainer"></div>
        <p style="text-align: center; margin-top: 30px; font-size: 0.8em; color: #999;">
            æœ¬å ±å‘Šç”± AI è¼”åŠ©ç”Ÿæˆï¼Œåƒ…ä¾›è¦åŠƒåƒè€ƒã€‚<br>å»ºè­°é ç´„æ‚¨çš„ CFP é¡§å•é€²è¡Œæ·±å…¥è§£è®€ã€‚
        </p>
    </div>
</div>

<div class="container" style="background: transparent; box-shadow: none; padding-top: 0;">
    <button id="downloadBtn" class="btn btn-download" onclick="downloadPDF()">ä¸‹è¼‰ PDF å ±å‘Š</button>
</div>

<script>
    // é¡Œç›®è³‡æ–™åº«
    const questions = {
        finance: ["è¢«å‹•æ”¶å…¥è¦†è“‹ç‡", "ç·Šæ€¥é å‚™é‡‘å……è¶³åº¦", "é†«ç™‚é˜²ç¦¦ä¿‚æ•¸", "è² å‚µæ­¸é›¶è¨ˆç•«", "è³‡ç”¢é…ç½®å¤šå…ƒæ€§"],
        health: ["èº«é«”è³ªé‡æŒ‡æ•¸ (BMI)", "è‚Œè‚‰é‡èˆ‡è¡Œå‹•åŠ›", "è¦å¾‹é‹å‹•ç¿’æ…£", "ç¡çœ å“è³ª", "å®¶æ—ç—…å²è¿½è¹¤"],
        social: ["éè·å ´æœ‹å‹æ•¸é‡", "è·¨ä»£é€£çµé »ç‡", "ç¤¾ç¾¤åƒèˆ‡åº¦", "è¦ªå¯†é—œä¿‚å¸³æˆ¶", "ç·Šæ€¥æ•‘æ´ç¶²"],
        purpose: ["èº«ä»½èªåŒåˆ‡æ›", "æ™‚é–“çµæ§‹åŒ–èƒ½åŠ›", "å¿ƒæµé«”é©—é »ç‡", "å­¸ç¿’æ–°æŠ€èƒ½æ„é¡˜", "åœ“å¤¢åŸ·è¡ŒåŠ›"]
    };

    // åˆå§‹åŒ–é¡Œç›®
    function initQuestions() {
        ['finance', 'health', 'social', 'purpose'].forEach((key, index) => {
            const container = document.getElementById(`q${index+1}-inputs`);
            questions[key].forEach((q, i) => {
                const div = document.createElement('div');
                div.className = 'question-group';
                div.innerHTML = `
                    <span class="question-label">${q}</span>
                    <input type="range" min="0" max="5" value="0" oninput="this.nextElementSibling.innerText = this.value" class="q-input" data-cat="${key}">
                    <span class="score-val" style="width: 30px; text-align: center; font-weight:bold;">0</span> åˆ†
                `;
                container.appendChild(div);
            });
        });
    }

    // é‚è¼¯æ ¸å¿ƒï¼šç”¢ç”Ÿå»ºè­°
    function getAdvice(score, type) {
        let level = score >= 20 ? 'high' : (score >= 11 ? 'mid' : 'low');
        
        const logic = {
            finance: {
                low: "ã€è­¦å ±ï¼šç”Ÿå­˜ç„¦æ…®æœŸã€‘è¢«å‹•æ”¶å…¥ä¸è¶³ã€‚å»ºè­°ç«‹å³åŸ·è¡Œã€Œå‚µå‹™é›ªçƒæ³•ã€ï¼Œä¸¦å¼·è¿«å„²è“„å­˜æ»¿3å€‹æœˆç·Šæ€¥é å‚™é‡‘ã€‚",
                mid: "ã€è­¦å ±ï¼šè³‡ç”¢ç´¯ç©æœŸã€‘æ”¶æ”¯å°šå¯ä½†è„†å¼±ã€‚å»ºè­°å°‡è¢«å‹•æ”¶å…¥è¦†è“‹ç‡ç›®æ¨™è¨­ç‚º70%ï¼Œä¸¦è£œè¶³é•·ç…§èˆ‡é†«ç™‚éšªç¼ºå£ã€‚",
                high: "ã€ç‹€æ…‹ï¼šè²¡å¯Œå‚³æ‰¿æœŸã€‘è²¡å‹™è‡ªç”±ã€‚å»ºè­°è«®è©¢ä¿¡è¨—æ¶æ§‹æˆ–ç¨…å‹™è¦åŠƒï¼Œç¢ºä¿è³‡ç”¢èƒ½ä¾æ„é¡˜æœ‰æ•ˆå‚³æ‰¿ã€‚"
            },
            health: {
                low: "ã€è­¦å ±ï¼šå¥åº·å´©å£æœŸã€‘é€™æ˜¯é€€ä¼‘æœ€å¤§é¢¨éšªã€‚è«‹ç«‹å³é ç´„å¥æª¢ï¼Œä¸¦å¾ã€Œæ¯å¤©æ­¥è¡Œ15åˆ†é˜ã€èˆ‡æ¸›ç³–é£²é£Ÿé–‹å§‹ã€‚",
                mid: "ã€è­¦å ±ï¼šäºå¥åº·èª¿æ•´æœŸã€‘è‚ŒåŠ›å¯èƒ½æµå¤±ã€‚å»ºè­°æ¯é€±å¢åŠ 2æ¬¡é˜»åŠ›è¨“ç·´ï¼Œä¸¦é…æˆ´è£ç½®ç›£æ§ç¡çœ æ•¸æ“šã€‚",
                high: "ã€ç‹€æ…‹ï¼šæ¨‚æ´»é•·å£½æœŸã€‘é«”æ³æ¥µä½³ã€‚å»ºè­°æŒ‘æˆ°éœ€ã€Œè…¦é«”å”èª¿ã€çš„æ–°é‹å‹•ï¼ˆå¦‚ç¶²çƒã€èˆè¹ˆï¼‰ä»¥ç¶­æŒå„ªå‹¢ã€‚"
            },
            social: {
                low: "ã€è­¦å ±ï¼šå­¤å³¶æ•ˆæ‡‰æœŸã€‘ç”Ÿæ´»åœˆç‹¹çª„ã€‚å»ºè­°æ¯æœˆä¸»å‹•è¯ç¹«ä¸€ä½è€å‹ï¼Œä¸¦å¼·åˆ¶è‡ªå·±åƒåŠ ä¸€å€‹å¯¦é«”èˆˆè¶£ç¤¾åœ˜ã€‚",
                mid: "ã€è­¦å ±ï¼šç¤¾äº¤é‡çµ„æœŸã€‘é€£çµæ·±åº¦ä¸è¶³ã€‚å»ºè­°æŒ‘é¸3ä½æœ‹å‹å»ºç«‹æ·±åº¦èšæœƒï¼Œä¸¦å»ºç«‹ç·Šæ€¥äº’åŠ©è¯çµ¡ç¶²ã€‚",
                high: "ã€ç‹€æ…‹ï¼šç¤¾ç¾¤æ¨ç´æœŸã€‘äººè„ˆå»£é—Šã€‚å»ºè­°é€²è¡Œç¤¾äº¤æ–·æ¨é›¢ï¼Œå°‡æ™‚é–“ç•™çµ¦å®¶äººèˆ‡åˆ©ä»–å‚³æ‰¿çš„æ´»å‹•ã€‚"
            },
            purpose: {
                low: "ã€è­¦å ±ï¼šå¤±å»é‡åŠ›æœŸã€‘è‡ªæˆ‘åƒ¹å€¼è¿·æƒ˜ã€‚è«‹ç·´ç¿’è‡ªæˆ‘ä»‹ç´¹æ™‚ã€Œä¸æè·ç¨±ã€ï¼Œä¸¦åˆ—å‡º10å€‹èˆˆè¶£é€²è¡Œä½æˆæœ¬è©¦éŒ¯ã€‚",
                mid: "ã€è­¦å ±ï¼šæ¢ç´¢å®šéŒ¨æœŸã€‘ç¼ºä¹åŸ·è¡ŒåŠ›ã€‚è«‹è¨­å®šå…·é«”çš„å­¸ç¿’ç›®æ¨™ï¼ˆå¦‚è€ƒè­‰ç…§ï¼‰ï¼Œå°‡èˆˆè¶£è½‰åŒ–ç‚ºå°å‹çš„åƒ¹å€¼ç”¢å‡ºã€‚",
                high: "ã€ç‹€æ…‹ï¼šè‡ªæˆ‘å¯¦ç¾æœŸã€‘ç›®æ¨™æ¸…æ™°ã€‚è«‹å³åˆ»å•Ÿå‹•åœ“å¤¢å¤§è¨ˆç•«ï¼Œæˆ–é€éå¯«ä½œæ¼”è¬›åˆ†äº«æ™ºæ…§ã€‚"
            }
        };
        return logic[type][level];
    }

    function generateReport() {
        let scores = { finance: 0, health: 0, social: 0, purpose: 0 };
        
        // è¨ˆç®—åˆ†æ•¸
        document.querySelectorAll('.q-input').forEach(input => {
            scores[input.dataset.cat] += parseInt(input.value);
        });

        let total = Object.values(scores).reduce((a, b) => a + b, 0);

        // æ¸²æŸ“çµæœ
        document.getElementById('totalScoreDisplay').innerText = `ç¸½åˆ†ï¼š${total} / 100`;
        
        // æ¸²æŸ“ç´°é …åˆ†æ•¸
        document.getElementById('scoreBreakdown').innerHTML = `
            <div>ğŸ’° è²¡å‹™: ${scores.finance}</div>
            <div>ğŸ’ª å¥åº·: ${scores.health}</div>
            <div>ğŸ¤ ç¤¾äº¤: ${scores.social}</div>
            <div>ğŸŒŸ æˆé•·: ${scores.purpose}</div>
        `;

        // æ¸²æŸ“å»ºè­°
        let adviceHtml = '';
        const labels = { finance: 'è²¡å‹™åŸºç«™', health: 'èº«å¿ƒçºŒèˆª', social: 'ç¤¾äº¤æ¼«éŠ', purpose: 'ç¬¬äºŒäººç”Ÿ' };
        
        for (let key in scores) {
            adviceHtml += `
                <div class="advice-box">
                    <div class="advice-title">${labels[key]} (å¾—åˆ†: ${scores[key]})</div>
                    <div class="advice-content">${getAdvice(scores[key], key)}</div>
                </div>
            `;
        }
        document.getElementById('adviceContainer').innerHTML = adviceHtml;

        // é¡¯ç¤ºçµæœå€èˆ‡ä¸‹è¼‰æŒ‰éˆ•
        document.getElementById('resultArea').style.display = 'block';
        document.getElementById('downloadBtn').style.display = 'block';
        
        // æ²å‹•åˆ°çµæœ
        document.getElementById('resultArea').scrollIntoView({behavior: "smooth"});
    }

    function downloadPDF() {
        const element = document.getElementById('reportContent');
        const opt = {
            margin:       10,
            filename:     'My_Retirement_Scorecard.pdf',
            image:        { type: 'jpeg', quality: 0.98 },
            html2canvas:  { scale: 2 },
            jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };
        // éš±è—æŒ‰éˆ•å†æˆªåœ–ï¼Œé¿å…æˆªåˆ°æŒ‰éˆ•
        document.querySelector('.btn').style.display = 'none';
        
        html2pdf().set(opt).from(element).save().then(() => {
            // æ¢å¾©æŒ‰éˆ•é¡¯ç¤º
            document.querySelector('.btn').style.display = 'block';
        });
    }

    // å•Ÿå‹•
    initQuestions();
</script>

</body>
</html>